pico-8 cartridge // http://www.pico-8.com
version 29
__lua__
function _init()
	cls()
	switch_state=0
	train={{64,8},{72,8},{80,8}}
end
function move_segment(s,dir)
	spd=dir*2
	--TOP SIDE
	if(s[2]<=8) then
		--top RIGHT 
		if(s[ 1]>=112) then
			s[2]+=spd
		else
			s[ 1]+=spd 
		end 
	--right SIDE
	elseif(s [ 1]>=112) then
		--bottom  RIGHT 
		if(s [2]>=112) then
			s[ 1]-=spd
		else
			s[ 2]+=spd
		end 
	--bottom  side
	elseif(s[ 2]>=112) then
		--bottom  left
		if(s[ 1]<=8)  then
			s[ 2]-=spd
		else
			s[ 1]-=spd
		end
	-- left side
	elseif(s [ 1]<=8) then
		--top left
		if(s [ 2]<=8) then
			s[ 1]+=spd
		else
			s[ 2]-=spd 
		end
	end
end
function adv_switch()
	if(switch_state<2) then
		switch_state+=1
	else
		switch_state=0 
	end
end
function move_train()
	for t in all(train) do
		move_segment(t,switch_state)
	end
end
function _update()
	if (btnp(4)) then
		adv_switch()
	end
	move_train()
end
function draw_train()
	local len=count(train)
	for t=1,len do
		if(t==1) then
			sprite=11
		else
			if(t==len) then
				sprite=13
			else 
				sprite=12
			end
		end
		spr(sprite,train[t][1],train[t][2])
	end
end
function draw_switch()
	if(switch_state==1) then
		sspr(0,16,16,16,56,56,16,16)
	else 
		sspr(64,16,16,16,56,56,16,16)
	end
end
function _draw()
	map(0,0,0,0,16,16)
	draw_switch()
	draw_train()
end
__gfx__
00000000000000004444444444454444444444444444444444444444666666660000000000000000000000000000000000000000000000000000000000000000
000000000000000055444444444554444666666666666666666666646666666688000000099000000e0000000000000000000000001111100000000000000000
000000000000000045444444444455444655555555555555555555646666666608800800009900900ee00ee00011000000111100001000100000000000000000
0000000000000000454444444444454446566646646664666646656466666666000888000009999000eee0000011100000111100001110000000000000000000
000000000000000044444454444444544654664664666466664645646666666608888000000999000eee00000010000000111010001000000000000000000000
000000000000000044444454444444554656455555555555555465646666666608000800099009900e00ee000011000000101010001000000000000000000000
0000000000000000444444544444444446566566666666666656656466666666000000800000000000000e000001110001000000000000000000000000000000
00000000000000004444445444444444465445644444444446544564666666660000000000000000000000000000000000000000000000000000000000000000
00000000000000004444445444444444465665644888844446566564000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000004444555444444444465665644486684446566564000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000004445544444444444465445644448668446544564000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000004454444444444544465665644444866846566564000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000004454444444455544465665644444866846566564000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000004454444444454444465445644448668446544564000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000004554444444544444465665644486684446566564000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000004544444445444444465665644888844446566564000000000000000000000000000000000000000000000000000000000000000000000000
0005555555555000000555555555500046544564444444444656656400000000000555dddd555000000000000000000000000000000000000000000000000000
005555555555dd00005555555555550046566566666666666654456400000000005555d77d555500000000000000000000000000000000000000000000000000
05555555555777d00555555555555550465645555555555555566564000000000555557777555550000000000000000000000000000000000000000000000000
5555555555dd77d5555555555555555546546646646664664646656400000000555555dddd555555000000000000000000000000000000000000000000000000
555555555dddd755555555555555555546566646646664664664656400000000555555dddd555555000000000000000000000000000000000000000000000000
55555555ddddd555555555555555555546555555555555555555556400000000555555dddd555555000000000000000000000000000000000000000000000000
5555555ddddd5555ddddddddddddd7dd46666666666666666666666400000000555555dddd555555000000000000000000000000000000000000000000000000
555555ddddd55555ddddddddddddd77d44444444444444444444444400000000555555dddd555555000000000000000000000000000000000000000000000000
55555ddddd555555ddddddddddddd77d66666666666666666666666600000000555555dddd555555000000000000000000000000000000000000000000000000
5555ddddd5555555ddddddddddddd7dd66688666666666666666666600000000555555dddd555555000000000000000000000000000000000000000000000000
555ddddd55555555555555555555555566888866699999966999999600000000555555dddd555555000000000000000000000000000000000000000000000000
55ddddd555555555555555555555555568877886697999966979979600000000555555dddd555555000000000000000000000000000000000000000000000000
5ddddd5555555555555555555555555568888886699799966997997600000000555555dddd555555000000000000000000000000000000000000000000000000
0dddd55555555550055555555555555066888866697999966979979600000000055555dddd555550000000000000000000000000000000000000000000000000
00dd555555555500005555555555550066688666699999966999999600000000005555dddd555500000000000000000000000000000000000000000000000000
0005555555555000000555555555500066666666666666666666666600000000000555dddd555000000000000000000000000000000000000000000000000000
__map__
0212020202020203030303131313131300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1204050505050505050505050505061200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1214120303030313030303131303161200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1214121213030303031303131212161200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1214131313131203030303120312161200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1314121203130303031303131312161200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1214120303130707343503131313160300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1214120313130707073613131213161200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1314130312130707070713031213161200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1314030312030707070703030303161200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1314030303030303030303120303160300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1314030312121212120312030312160300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1314121212031212031312131312160300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1314031203120312030303030303160200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1324252525252525252525252525260200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1213131313030312031203120202020300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
